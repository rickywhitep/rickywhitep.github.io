Bloque A: Carga y Datos;[Scilab] Cargar matriz desde archivo .txt;M = fscanfMat('libelulasyranas.txt') [cite: 21]
Bloque A: Carga y Datos;[Maxima] Cargar matriz desde archivo .txt;load(numericalio)$ M : read_matrix("libelulasyranas.txt")$ [cite: 22]
Bloque A: Carga y Datos;[Scilab] Extraer columna i de una matriz;col = M(:, i) // Donde i=1 para libélulas y i=2 para ranas [cite: 21]
Bloque A: Carga y Datos;[Scilab] Crear vector de tiempo (3 años en semanas);t = 1 : 1 : 156 // 3 años * 52 semanas [cite: 21]
Bloque A: Carga y Datos;[Scilab] Representar dos series en la misma gráfica;plot(t, L, t, R) [cite: 22]
Bloque B: Correlación;[Scilab] Rango de serie L para desfase d;L_rango = L(1 : N-d) [cite: 24, 26]
Bloque B: Correlación;[Scilab] Rango de serie R para desfase d;R_rango = R(d+1 : N) [cite: 24, 26]
Bloque B: Correlación;[Scilab] Media local para correlación cruzada;L_bar = mean(L(1 : N-d)) [cite: 24, 26]
Bloque B: Correlación;[Scilab] Encontrar valor máximo y su posición en vector;[val, pos] = max(vector_correlaciones) [cite: 30]
Bloque C: Filtrado;[Scilab] Copiar serie para inicializar filtrado;Sf = S // Mantiene originales los valores que no cumplen la condición i > K+1 [cite: 32, 34]
Bloque C: Filtrado;[Scilab] Fórmula media móvil centrada (punto i);Sf(i) = (1/(2*K+1)) * sum(S(i-K : i+K)) [cite: 32]
Bloque C: Filtrado;[Scilab] Condición lógica para aplicar filtro;if (i > K+1) & (i < N-K) then ... end [cite: 33]
Bloque D: Ajuste Maxima;[Maxima] Definir función fL(a, b, t) con Pi;fL(a, b, t) := 300 + a * sin(2*%pi*t/52) + b * t [cite: 39]
Bloque D: Ajuste Maxima;[Maxima] Estructura bucle búsqueda parámetros;for a : 100 step 1 thru 200 do ( for b : -0.5 step 0.05 thru 0.5 do ( ... ) ) [cite: 46]
Bloque D: Ajuste Maxima;[Maxima] Sumatorio Error Cuadrático (EC);EC : lsum(sqrt((fL(a, b, i) - L[i])^2), i, 1, N) [cite: 44]
Bloque D: Ajuste Maxima;[Maxima] Actualizar mínimo si EC es menor;if (EC < error_min) then (error_min : EC, mejor_a : a, mejor_b : b) [cite: 43]
Bloque E: Extinciones;[Maxima] Ecuación tendencia lineal para extinción;T(b, t) := constante + b * t [cite: 49]
Bloque E: Extinciones;[Maxima] Resolver tiempo de extinción (años);solve(T(b, t) = 0, t) / 52 [cite: 50]